<!DOCTYPE html><html><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no"><meta content='#000000' name='theme-color'/><meta name="keywords" content="Site, Rocket.Chat, Slack, Communication"><title>Rocket.Chat | Configuración de LDAP</title><!-- Open Graph general (Facebook, Pinterest & Google+) --><meta name="og:title" content="Rocket.Chat | Configuración de LDAP"><meta name="og:description" content="Este post esta dedicado a hablar de la configuración de LDAP en Rocket.Chat, así de como usar otros tipos de autenticaciones."><meta name="og:image" content="/assets/images/ldap.png"><meta name="og:image:alt" content="Rocket.Chat | Configuración de LDAP"><meta name="og:url" content="/blog/ldap-post"><meta name="article:author" content="https://www.facebook.com/Manu Lora Roman"><meta name="og:site_name" content="Rocket.Chat | Configuración de LDAP"><meta name="og:type" content="website"> <!-- Twitter --><meta property="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Rocket.Chat | Configuración de LDAP"><meta name="twitter:description" content="Este post esta dedicado a hablar de la configuración de LDAP en Rocket.Chat, así de como usar otros tipos de autenticaciones."><meta name="twitter:site" content="@ManuelLoraRoman"><meta name="twitter:creator" content="@ManuelLoraRoman"><meta name="twitter:image:src" content="/assets/images/ldap.png"> <!-- Search Engine --><meta name="description" content="Este post esta dedicado a hablar de la configuración de LDAP en Rocket.Chat, así de como usar otros tipos de autenticaciones."><meta name="image" content="/assets/images/ldap.png"> <!-- Schema.org for Google --><meta itemprop="name" content="Rocket.Chat | Configuración de LDAP"><meta name="author" content="ManuelLoraRoman"/><meta itemprop="description" content="Este post esta dedicado a hablar de la configuración de LDAP en Rocket.Chat, así de como usar otros tipos de autenticaciones."><meta itemprop="image" content="/assets/images/ldap.png"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', ''); </script><title>Rocket.Chat</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script><link rel="shortcut icon" href="/assets/images/favicon-16x16.png" type="image/x-icon"></head></head><body><nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar"><div class="container"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="/"> <strong>Rocket.Chat</strong> </a><div class="navbar-burger" data-target="navbar-menu"> <span></span> <span></span> <span></span></div></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu has-background-black" id="navbar-menu"> <!-- navbar items | left side --> <!--<div class="navbar-start"></div>--> <!-- navbar items | right side --><div class="navbar-end"> <a class="navbar-item " href="/">HOME</a> <a class="navbar-item" href="/#about">ABOUT</a> <a class="navbar-item" href="/#contact">CONTACT</a> <a class="navbar-item " href="/blog">BLOG</a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown has-background-black is-left"> <a href="/project" class="navbar-item has-text-grey-light "> Projects </a> <a href="/test-page" class="navbar-item has-text-grey-light "> Test Page </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', function () { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(function ($el) { $el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = $el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ $el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/blog/ldap-post" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold ">Configuración de LDAP</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="/assets/images/ldap.png" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">Este post esta dedicado a hablar de la configuración de LDAP en Rocket.Chat, así de como usar otros tipos de autenticaciones.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>May 06, 2021</b> by <a href="https://github.com/ManuelLoraRoman/" target="_blank"><b class="has-text-link"><u>ManuelLoraRoman</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">LDAP</span> <span class="tag is-link">Rocket.Chat</span> <span class="tag is-link">Settings</span> <span class="tag is-link">Authentication</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 7 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><p><p>Rocket.Chat, como hemos comentado anteriormente, permite que los usuarios se autentiquen para entrar al servidor mediante LDAP.</p><p>Podemos acceder a la configuración de LDAP de la siguiente manera:</p><ul><li><p>Accedemos al servidor como accedemos normalmente.</p></li><li><p>En la siguiente ventana, pinchar en el icono de la parte superior izquierda, y acceder a la opción de Administración.</p></li></ul><div style="text-align: center"><img src="/assets/images/ldap1.png" width="1000" /></div><p><br /> Una vez ahí, se nos desplegará un listado con varias opciones. Nos tendremos que ir a la sección de Configuración y, para que sea más sencillo, poner en el buscador “LDAP” y acceder:</p><div style="text-align: center"><img src="/assets/images/ldap2.png" width="300" /></div><ul><li><p>A continuación, se nos desplegará las opciones de las que dispone LDAP. Nosotros seleccionaremos las siguientes opciones para nuestro uso personal:</p><ul><li><strong>Habilitar</strong> –&gt; ON</li></ul><p>Debemos seleccionar esta opción para que podamos utilizar LDAP</p><ul><li><strong>Login Fallback</strong> –&gt; OFF</li></ul><p>En nuestro caso, no lo vamos a seleccionar por ahora, ya que en principio queremos que todos los inicios de sesión sean mediante LDAP.</p><ul><li><strong>Encontrar usuario después de iniciar sesión</strong> –&gt; ON</li></ul><p>Garantiza que se realizó correctamente la búsqueda del DN del usuario después de la vinculación.</p><ul><li><strong>Servidor</strong></li></ul><p>En el cuadro de texto, debemos incorporar o el nombre del servidor LDAP o su dirección IP.</p><ul><li><strong>Puerto</strong></li></ul><p>Puerto para acceder a nuestro servidor LDAP</p><ul><li><strong>Vuelva a conectar</strong> –&gt; ON</li></ul><p>Cuando la conexión se vea interrumpida, permite intentar conectarse automáticamente de nuevo.</p><ul><li><strong>Cifrado</strong> –&gt; deshabilitado</li></ul><p>En nuestro caso, como no lo tenemos configurado no pondremos ningún cifrado, pero en el caso del instituto, usaremos SSL/LDAPS.</p><ul><li><strong>CA Cert / Rechazar no autorizada</strong> –&gt; OFF</li></ul><p>Puesto que no vamos a utilizar cifrado, estas opciones están desactivadas.</p><ul><li><strong>Base DN</strong></li></ul><p>El nombre distinguido completamente calificado de un subárbol LDAP donde quieras buscar usuarios y grupos.</p><p>En nuestro caso, hemos creado un servidor LDAP con unos datos de prueba, así que usaremos el siguiente:</p><div style="text-align: center"><img src="/assets/images/ldap3.png" width="600" /></div><ul><li><strong>Nivel de Registro interno</strong> –&gt; Deshabilitado</li></ul></li></ul><p>A partir de aquí, ya se podría comprobar la conexión con el botón de color azul. También, en cualquier caso, podemos restablecer la configuración de esta sección.</p><div style="text-align: center"><img src="/assets/images/ldap4.png" width="500" /></div><ul><li><p>Ahora pasaremos inmediatamente a configurar la sección llamada <em>Autenticación</em>, que es la otra parte importante para configurar LDAP. En ella, nos encontramos las siguientes opciones:</p><ul><li><strong>Habilitar</strong> –&gt; ON</li></ul><p>Habilitamos la autenticación de LDAP</p><ul><li><strong>DN de usuario</strong></li></ul><p>El usuario usado para realizar las búsquedas de usuarios y para autenticarlos. Usualmente, se utiliza el administrador del servidor LDAP.</p><div style="text-align: center"><img src="/assets/images/ldap5.png" width="500" /></div><ul><li><strong>Contraseña</strong></li></ul><p>La contraseña LDAP usada para el administrador anteriormente puesto. <br /></p></li><li><p>Terminada esta sección, pasaremos a la siguiente, <em>Sincronizar/Importar</em>. Esta sección nos permitirá configurar la búsqueda de usuarios y la posterior incorporación como usuarios en nuestro servidor Rocket.Chat. Esta sección dispone de las siguientes opciones:</p><ul><li><strong>Campo de Nombre</strong></li></ul><p>El campo utilizado como Nombre de usuario en Rocket.Chat para los nuevos usuarios. Si este campo se deja en blanco, se usará el nombre de usuario informado en la página de inicio de sesión.</p><p>En nuestro caso, hemos utilizado el campo LDAP “givenName”.</p><ul><li><strong>Campo Identificador Único</strong></li></ul><p>El campo que se utilizará para vincular al usuario LDAP y el usuario Rocket.Chat. Dejar el valor por defecto.</p><div style="text-align: center"><img src="/assets/images/ldap6.png" width="500" /></div><ul><li><strong>Dominio Predeterminado</strong></li></ul><p>Se usa para crear un correo electrónico exclusivo para los usuarios donde el correo electrónico no se haya implementado mediante LDAP. Nosotros usaremos el siguiente:</p><div style="text-align: center"><img src="/assets/images/ldap7.png" width="500" /></div><ul><li><p><strong>Fusionar usuarios existentes</strong> –&gt; ON</p></li><li><p><strong>Sincronizar Datos de Usuario</strong> –&gt; ON</p></li></ul><p>Mantiene los datos del usuario en sincronía con el servidor al iniciar sesión.</p><ul><li><strong>Mapa de Campos de Datos de Usuario</strong></li></ul><p>Configura los campos de usuario del servidor Rocket.Chat, poblándolos con los datos de los registros LDAP. Los únicos campos que están disponibles en Rocket.Chat son: name, email y customFields.</p><p>Nosotros lo hemos configurado de la siguiente forma:</p><div style="text-align: center"><img src="/assets/images/ldap8.png" width="600" /></div><ul><li><p><strong>Sincronizar grupos de LDAP</strong> –&gt; ON</p></li><li><p><strong>Eliminar automáticamente roles de usuario</strong> –&gt; OFF</p></li></ul><p>Se eliminan los roles de Rocket.Chat para implementar roles según los asignados en el servidor LDAP.</p><ul><li><strong>Filtro de grupo de usuarios</strong></li></ul><p>Filtro usado para verificar que un usuario pertenece a un grupo. Dejar el valor por defecto:</p><div style="text-align: center"><img src="/assets/images/ldap9.png" width="600" /></div><ul><li><strong>Base DN de grupos LDAP</strong></li></ul><p>DN base utilizado para buscar usuarios. En nuestro caso, no hemos utilizado dicha opción.</p><ul><li><strong>Mapa de grupo de datos de usuario</strong></li></ul><p>Mapea los grupos de LDAP a los roles de usuario de Rocket.Chat. No hemos tocado más allá del valor por defecto:</p><div style="text-align: center"><img src="/assets/images/ldap10.png" width="600" /></div><ul><li><strong>Sincronizar automáticamente los grupos de LDAP a Channels</strong> –&gt; OFF</li></ul><p>Si se habilita esta opción, añadirá automáticamente a los usuarios a un canal basándose en su grupo LDAP.</p><ul><li><strong>Channel Administrator</strong></li></ul><p>Administrador por defecto en caso de que se creen automáticamente canales que no existan durante la sincronización. Dejaremos el usuario por defecto</p><div style="text-align: center"><img src="/assets/images/ldap11.png" width="500" /></div><ul><li><strong>Mapa del Channel Grupo LDAP</strong></li></ul><p>Dejamos los valores por defecto. Mapea los grupos LDAP a los canales de Rocket.Chat.</p><ul><li><strong>Eliminar automáticamente usuarios de Salas</strong> –&gt; OFF</li></ul><p>Habilita esta opción si desea eliminar a cualquier usuario en un canal que no esté en el grupo LDAP.</p><ul><li><strong>Sincronizar Avatar del Usuario / Campo de avatar de Usuario</strong> –&gt; OFF</li></ul><p>En caso de que queramos que nuestros usuarios dispongan del avatar de usuario, seleccionaremos el campo LDAP el cual tenga el avatar de usuario.</p><ul><li><p><strong>Sincronización de fondo</strong> –&gt; ON</p></li><li><p><strong>Intervalo de sincronización de fondo</strong></p></li></ul><p>Se puede usar diferentes formatos para el intervalo: <a href="http://bunkat.github.io/later/parsers.html#text">Cron Text Parser</a></p><ul><li><strong>Sincronización de fondo - Importar nuevos usuarios</strong> –&gt; ON</li></ul><p>Importará todos los usuarios (según criterios de filtro) que existen en LDAP y no en Rocket.Chat.</p><ul><li><strong>Actualización de sincronización de fondo de usuarios existentes</strong> –&gt; ON</li></ul><p>Sincronizará el avatar, los campos, el nombre de usuario, etc de todos los usuarios ya importados.</p></li><li><p>Por último, debemos pulsar el siguiente botón azul para que se ejecute la sincronización.</p></li></ul><div style="text-align: center"><img src="/assets/images/ldap12.png" width="300" /></div><p>Una vez realizado los cambios, ya tendríamos una configuración inicial de LDAP. Lo único ya sería esperar a que se conecte al servidor y se sincronicen los usuarios de LDAP.</p><p>Una vez haya terminado la sincronización, podremos acceder a los usuarios en la siguiente pestaña Administración &gt; Usuarios:</p><div style="text-align: center"><img src="/assets/images/ldap13.png" width="1000" /></div><p><br /></p><p>Los usuarios añadidos mediante LDAP en nuestro caso serán los mismos añadidos mediante este fichero:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dn: uid=maria,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
objectClass: person
cn:: TWFyaWEgZGVsIENhcm1lbiBMb3JhIFJvbcOhbgo=
uid: maria
uidNumber: 2002
gidNumber: 2502
homeDirectory: /home/maria
loginShell: /bin/bash
userPassword:: {SSHA}OuK8ryroLXs+fpudBXcJrMTZ3ASD/H46
sn:: TG9yYSBSb23DoW4K
mail: marialoraroman@gmail.com
givenName: maria

dn: uid=rosaura,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: Um9zYXVyYSBIYWJhIFBlcmVhCg==
uid: rosaura
uidNumber: 2003
gidNumber: 2503
homeDirectory: /home/rosaura
loginShell: /bin/bash
userPassword: {SSHA}sgJUlNb20SdYbUclyXQNFCe0tjjdijdS
sn: SGFiYSBQZXJlYQo=
mail: rosaurahabaperea@gmail.com
givenName: rosaura

dn: uid=laura,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: TGF1cmEgTW9yYWxlcyBDYWJlbGxvCg==
uid: laura
uidNumber: 2004
gidNumber: 2504
homeDirectory: /home/laura
loginShell: /bin/bash
userPassword: {SSHA}bZ1BzoZWQGN25d5ecDzOVfaSi35h7/Dq
sn: TW9yYWxlcyBDYWJlbGxvCg==
mail: lauramoralescabello@gmail.com
givenName: laura

dn: uid=pablo,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: UGFibG8gU3VzbyBHb256YWxlego=
uid: pablo
uidNumber: 2005
gidNumber: 2505
homeDirectory: /home/pablo
loginShell: /bin/bash
userPassword: {SSHA}1Dmh5fQgowk0Cvfzje4B71kC1SmeiIqi
sn: U3VzbyBHb256YWxlego=
mail: pablosusogonzalex@gmail.com
givenName: pablo

dn: uid=arturo,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: QXJ0dXJvIEJvcnJlcm8gR29uemFsZXoK
uid: arturo
uidNumber: 2006
gidNumber: 2506
homeDirectory: /home/arturo  
loginShell: /bin/bash
userPassword: {SSHA}RoA4bctGSRG537NslZYSifHAmzf0DWTv
sn: Qm9ycmVybyBHb256YWxlego=
mail: arturo@debian.org
givenName: arturo

dn: uid=diego,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: RGllZ28gTG9zYWRhIEZ1ZW50ZXMK
uid: diego
uidNumber: 2007
gidNumber: 2507
homeDirectory: /home/diego
loginShell: /bin/bash
userPassword: {SSHA}pclPYfaM0zvJos+h86gu+bx//Q+UULyj
sn: TG9zYWRhIEZ1ZW50ZXMK
mail: dlosadafuentes@gmail.com
givenName: diego

dn: uid=isabel,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: SXNhYmVsIE1vcmFsZXMgQ2FiZWxsbwo=
uid: isabel
uidNumber: 2008
gidNumber: 2508
homeDirectory: /home/isabel
loginShell: /bin/bash
userPassword: {SSHA}cBES958lKSd7Trpj7Yrah5yHfX4Ikl/e
sn: TW9yYWxlcyBDYWJlbGxvCg==
mail: isabelmoralescabello@gmail.com
givenName: isabel

dn: uid=alberto,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: QWxiZXJ0byBDb3Jkb24gQXJldmFsbwo=
uid: alberto
uidNumber: 2009
gidNumber: 2509
homeDirectory: /home/alberto
loginShell: /bin/bash
userPassword: {SSHA}GMTZonB3W7TcL9D0BEVfO7Z6xUVKbir8
sn: Q29yZG9uIEFyZXZhbG8K
mail: albertocordonarevalo@gmail.com
givenName: alberto

dn: uid=rosalia,ou=People,dc=manuel-lora,dc=gonzalonazareno,dc=org
objectClass: top
objectClass: posixAccount
objectClass: inetOrgPerson
cn:: Um9zYWxpYSBDb3Jkb24gQXJldmFsbwo=
uid: rosalia
uidNumber: 2010
gidNumber: 2510
homeDirectory: /home/rosalia
loginShell: /bin/bash
userPassword: {SSHA}fmbcJQuDFJY6+fW3KXBs8NDHugw5ULuO
sn: Q29yZG9uIEFyZXZhbG8K
mail: rosaliacordonarevalo@gmail.com
givenName: rosalia
</code></pre></div></div><p><br /></p><div> <span style="margin-right:980px;text-align:left;color:blue" onclick="document.location.href = 'admin-post'; return false">&lt; Opciones de administrador</span> <span style="margin-left:0px;float:right;color:blue" onclick="document.location.href = 'ldap-post'; return false">Configuración de LDAP &gt;</span></div></p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer id="footer"> <!--Footer Button--><div class="container has-text-centered has-background-grey-darker" id="backtotop"> <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div class="has-background-grey-darker"><div class="container columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centered-mobile"> <a href="/#about"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet"><figure class="image is-64x64"> <img class="is-rounded" src="https://pbs.twimg.com/profile_images/924861277956173824/1x1O3l3v_400x400.jpg"></figure></div><div class="column is-marginless"><h5 class="has-text-grey-lighter">ManuelLoraRoman</h5><div class="content has-text-grey"><p>Administrador de Sistemas Informáticos en Red. DevOps</p></div></div></div></a></div><!--Link Section--><div class="column has-text-white"><h3>More Links</h3><li> <a href="/test-page">Test Page</a></li><li> <a target="_blank" href="/feed.xml">Subscribe via RSS</a></li></div><!--Blog-post Section--><div class="column has-text-white"><h3>Recent Posts</h3><li> <a href="/blog/proxy-post">Proxy inverso y Rocket.Chat</a></li><li> <a href="/blog/certificate-post">Cumplimiento de Rocket.Chat</a></li><li> <a href="/blog/ldap-post">Configuración de LDAP</a></li></div></div></div><div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2021 | <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer">WhatATheme</a> - A Theme made with <i class="fas fa-heart has-text-danger"></i> by <a href="https://www.twitter.com/thedevslot" target="_blank" rel="noopener noreferrer">TheDevsLot</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a></div></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://thedevslot.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
